nextflow_process {

    name "Test Process INDEX_CHUNKED_VCFS"
    script "modules/index_chunked_vcfs.nf"
    process "INDEX_CHUNKED_VCFS"

    test("Should run without failures") {

        when {
            params {
                // define parameters here. Example:
                // outdir = "tests/results"
            }
            process {
                """
                input[0] = file("${projectDir}/tests/data/concat_chunked_vcfs_input/10_chunked.vcf.gz")
                """
            }
        }

        then {
            assert process.success
            with(process.out.indexed_vcfs) {
                assert size() == 1, "Expected 1 indexed VCF file, got ${size()}"
                def indexedVcf = get(0)
                def indexedVcfPath = path(indexedVcf).toString()
                println("Indexed VCF: ${indexedVcfPath}")
                assert indexedVcfPath.endsWith('.tbi'), "Expected indexed VCF to have .tbi extension but found ${indexedVcfPath}"
            }
        }

    }

}
